<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ§­ íƒì‚¬ì› & ğŸ‘ï¸ ê´´ì´ ì „íˆ¬ ì‹œë®¬ë ˆì´í„°</title>
<style>
  body {
    background-color: #111;
    color: #eee;
    font-family: "Pretendard", sans-serif;
    margin: 0;
    padding: 20px;
    text-align: center;
  }

  h1 { margin: 10px 0; }

  .main-container {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: 20px;
    flex-wrap: wrap;
  }

  .side-panel {
    width: 200px;
    background-color: #1a1a1a;
    border-radius: 10px;
    padding: 15px;
    box-shadow: 0 0 10px #333;
    text-align: left;
  }

  .container {
    flex-grow: 1;
    max-width: 700px;
    display: flex;
    justify-content: space-around;
    gap: 20px;
    flex-wrap: wrap;
    position: relative;
  }

  .card {
    background-color: #222;
    padding: 20px;
    border-radius: 15px;
    width: 300px;
    box-shadow: 0 0 10px #333;
    flex-shrink: 0;
  }

  button {
    margin-top: 10px;
    padding: 8px 18px;
    border: none;
    border-radius: 5px;
    background-color: #555;
    color: #fff;
    cursor: pointer;
    font-size: 15px;
  }

  button:hover { background-color: #777; }

  .result-box {
    margin-top: 10px;
    background-color: #111;
    padding: 10px;
    border-radius: 5px;
    min-height: 30px;
  }

  .log-container {
    width: 100%;
    max-width: 700px;
    margin: 20px auto 0;
    text-align: center;
  }

  .log {
    background-color: #1a1a1a;
    padding: 15px;
    border-radius: 10px;
    text-align: left;
    width: 100%;
    box-shadow: 0 0 10px #333;
    max-height: 300px;
    overflow-y: auto;
  }

  .log-entry {
    margin: 5px 0;
    display: flex;
    justify-content: flex-start;
    align-items: center;
  }

  .divider {
    text-align: center;
    color: #888;
    margin: 10px 0;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .divider button {
    margin-left: 10px;
    background-color: #444;
    border: none;
    color: #fff;
    border-radius: 8px;
    padding: 4px 10px;
    cursor: pointer;
  }
</style>
</head>
<body>

<h1>ğŸ§­ íƒì‚¬ì› & ğŸ‘ï¸ ê´´ì´ ì „íˆ¬ ì‹œë®¬ë ˆì´í„°</h1>

<div class="main-container">
  <div class="side-panel">
    <h3>ğŸ§­ íƒì‚¬ì› ì²´ë ¥</h3>
    <div id="guardianStatus"></div>
  </div>

  <div class="container">
    <div class="card">
      <h2>ğŸ§­ íƒì‚¬ì›</h2>
      <label>ì°¸ì—¬ ì¸ì›:
        <select id="guardianCount"></select>
      </label><br>
      <label><input type="checkbox" id="g30"> 1D30</label><br>
      <button onclick="rollGuardian()">êµ´ë¦¬ê¸°</button>
      <div class="result-box" id="guardianResult">ê²°ê³¼: -</div>
    </div>

    <div class="card">
      <h2>ğŸ‘ï¸ ê´´ì´</h2>
      <label>ê´´ì´ ìˆ˜:
        <select id="angelCount"></select>
      </label><br>
      <label><input type="checkbox" id="a60"> 1D60</label><br>
      <button onclick="rollAngel()">êµ´ë¦¬ê¸°</button>
      <div class="result-box" id="angelResult">ê²°ê³¼: -</div>
    </div>

    <div class="log-container">
      <button onclick="resetAll()">ğŸ” ë‹¤ì‹œ ì‹œì‘</button>
      <h2>ğŸ“œ ì „íˆ¬ ë¡œê·¸</h2>
      <div class="log" id="battleLog"></div>
    </div>
  </div>

  <div class="side-panel">
    <h3>ğŸ‘ï¸ ê´´ì´ ì²´ë ¥</h3>
    <div id="angelStatus"></div>
  </div>
</div>

<script>
const guardianSelect = document.getElementById('guardianCount');
const angelSelect = document.getElementById('angelCount');
const logBox = document.getElementById('battleLog');
const guardianStatus = document.getElementById('guardianStatus');
const angelStatus = document.getElementById('angelStatus');

let guardianHP = [];
let angelHP = [];
let guardianIndex = 0;
let angelIndex = 0;
let turn = 1;

for (let i = 1; i <= 40; i++) {
  guardianSelect.innerHTML += `<option value="${i}">${i}ëª…</option>`;
}
for (let i = 1; i <= 5; i++) {
  angelSelect.innerHTML += `<option value="${i}">${i}ëª…</option>`;
}

function rollDice(sides) {
  return Math.floor(Math.random() * sides) + 1;
}

function log(text) {
  const entry = document.createElement('div');
  entry.className = 'log-entry';
  entry.textContent = text;
  logBox.appendChild(entry);
  logBox.scrollTop = logBox.scrollHeight;
}

function addDivider() {
  const div = document.createElement('div');
  div.className = 'divider';

  const turnText = document.createElement('span');
  turnText.textContent = `â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ [í„´ ${turn}] â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€`;
  div.appendChild(turnText);

  const copyBtn = document.createElement('button');
  copyBtn.textContent = 'ğŸ“‹ ë³µì‚¬';
  copyBtn.onclick = () => {
    let textToCopy = '';
    let sibling = div.nextSibling;
    while (sibling && !sibling.classList.contains('divider')) {
      if (sibling.classList.contains('log-entry')) {
        textToCopy += sibling.innerText + '\n';
      }
      sibling = sibling.nextSibling;
    }
    navigator.clipboard.writeText(textToCopy);
  };
  div.appendChild(copyBtn);

  logBox.appendChild(div);
  turn++;
}

function initializeHP() {
  guardianHP = Array(parseInt(guardianSelect.value)).fill(100);
  angelHP = Array(parseInt(angelSelect.value)).fill(200);
  updateStatus();
}

function updateStatus() {
  guardianStatus.innerHTML = guardianHP.map((hp,i)=>`<div>íƒì‚¬ì› ${i+1} â†’ ${hp}</div>`).join('');
  angelStatus.innerHTML = angelHP.map((hp,i)=>`<div>ê´´ì´ ${i+1} â†’ ${hp}</div>`).join('');
}

function rollGuardian() {
  if (guardianHP.length === 0) initializeHP();
  if (!g30.checked) return;

  addDivider();
  const roll = rollDice(30);
  log(`ğŸ§­ íƒì‚¬ì› 1D30 â†’ ${roll}`);

  for (let i = 0; i < angelHP.length; i++) {
    const idx = (angelIndex + i) % angelHP.length;
    if (angelHP[idx] > 0) {
      angelHP[idx] = Math.max(0, angelHP[idx] - roll);
      log(`ğŸ‘ï¸ ê´´ì´ ${idx+1} ë‚¨ì€ ì²´ë ¥ â†’ ${angelHP[idx]}`);
      angelIndex = idx;
      break;
    }
  }
  updateStatus();
}

function rollAngel() {
  if (guardianHP.length === 0) initializeHP();
  if (!a60.checked) return;

  addDivider();
  const roll = rollDice(60);
  log(`ğŸ‘ï¸ ê´´ì´ 1D60 â†’ ${roll}`);

  for (let i = 0; i < guardianHP.length; i++) {
    const idx = (guardianIndex + i) % guardianHP.length;
    if (guardianHP[idx] > 0) {
      guardianHP[idx] = Math.max(0, guardianHP[idx] - roll);
      log(`ğŸ§­ íƒì‚¬ì› ë‚¨ì€ ì²´ë ¥ â†’ ${guardianHP[idx]}`);
      guardianIndex = idx + 1;
      break;
    }
  }
  updateStatus();
}

function resetAll() {
  guardianHP = [];
  angelHP = [];
  guardianIndex = 0;
  angelIndex = 0;
  turn = 1;
  guardianStatus.innerHTML = '';
  angelStatus.innerHTML = '';
  logBox.innerHTML = '';
}
</script>

</body>
</html>
